(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-946d62a8"],{"0908":function(t,e,i){"use strict";var r=i("5b5b"),n=i.n(r);n.a},"12f8":function(t,e,i){"use strict";var r=i("c065"),n=i.n(r);n.a},"1a26":function(t,e,i){"use strict";var r=i("bb0f"),n=i.n(r);n.a},2262:function(t,e,i){t.exports=i.p+"img/player_cover.373e0739.png"},3169:function(t,e,i){"use strict";var r=i("39fe"),n=i.n(r);n.a},"39fe":function(t,e,i){},"3d03":function(t,e,i){},4814:function(t,e,i){"use strict";var r=i("3d03"),n=i.n(r);n.a},"5b5b":function(t,e,i){},"9a33":function(t,e,i){"use strict";var r=i("2fd4"),n=i("69b3"),s=i("f63e"),c=i("e754"),o=i("eafa"),a=i("7108"),u=i("8714"),l=i("238a"),m=Math.min,d=[].push,h="split",f="length",v="lastIndex",p=4294967295,y=!l((function(){RegExp(p,"y")}));i("0aed")("split",2,(function(t,e,i,l){var g;return g="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[f]||2!="ab"[h](/(?:ab)*/)[f]||4!="."[h](/(.?)(.?)/)[f]||"."[h](/()()/)[f]>1||""[h](/.?/)[f]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!r(t))return i.call(n,t,e);var s,c,o,a=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,h=void 0===e?p:e>>>0,y=new RegExp(t.source,l+"g");while(s=u.call(y,n)){if(c=y[v],c>m&&(a.push(n.slice(m,s.index)),s[f]>1&&s.index<n[f]&&d.apply(a,s.slice(1)),o=s[0][f],m=c,a[f]>=h))break;y[v]===s.index&&y[v]++}return m===n[f]?!o&&y.test("")||a.push(""):a.push(n.slice(m)),a[f]>h?a.slice(0,h):a}:"0"[h](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,r){var n=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,n,r):g.call(String(n),i,r)},function(t,e){var r=l(g,t,this,e,g!==i);if(r.done)return r.value;var u=n(t),d=String(this),h=s(u,RegExp),f=u.unicode,v=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(y?"y":"g"),b=new h(y?u:"^(?:"+u.source+")",v),C=void 0===e?p:e>>>0;if(0===C)return[];if(0===d.length)return null===a(b,d)?[d]:[];var P=0,M=0,x=[];while(M<d.length){b.lastIndex=y?M:0;var O,_=a(b,y?d:d.slice(M));if(null===_||(O=m(o(b.lastIndex+(y?0:M)),d.length))===P)M=c(d,M,f);else{if(x.push(d.slice(P,M)),x.length===C)return x;for(var w=1;w<=_.length-1;w++)if(x.push(_[w]),x.length===C)return x;M=P=O}}return x.push(d.slice(P)),x}]}))},"9e76":function(t,e,i){"use strict";var r=i("69b3"),n=i("eafa"),s=i("e754"),c=i("7108");i("0aed")("match",1,(function(t,e,i,o){return[function(i){var r=t(this),n=void 0==i?void 0:i[e];return void 0!==n?n.call(i,r):new RegExp(i)[e](String(r))},function(t){var e=o(i,t,this);if(e.done)return e.value;var a=r(t),u=String(this);if(!a.global)return c(a,u);var l=a.unicode;a.lastIndex=0;var m,d=[],h=0;while(null!==(m=c(a,u))){var f=String(m[0]);d[h]=f,""===f&&(a.lastIndex=s(u,n(a.lastIndex),l)),h++}return 0===h?null:d}]}))},b76b:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music"},[i("div",{staticClass:"music-content"},[i("div",{staticClass:"music-left"},[i("music-btn"),i("keep-alive",[t.$route.meta.keepAlive?i("router-view",{staticClass:"music-list"}):t._e()],1),t.$route.meta.keepAlive?t._e():i("router-view",{key:t.$route.path,staticClass:"music-list"})],1),i("lyric",{staticClass:"music-right",attrs:{lyric:t.lyric,nolyric:t.nolyric,"lyric-index":t.lyricIndex}})],1),i("div",{staticClass:"music-bar",class:{disable:!t.musicReady||!t.currentMusic.id}},[i("div",{staticClass:"music-bar-btns"},[i("mm-icon",{staticClass:"pointer",attrs:{type:"prev",size:36,title:"上一曲 Ctrl + Left"},on:{click:t.prev}}),i("div",{staticClass:"control-play pointer",attrs:{title:"播放暂停 Ctrl + Space"},on:{click:t.play}},[i("mm-icon",{attrs:{type:t.playing?"pause":"play",size:24}})],1),i("mm-icon",{staticClass:"pointer",attrs:{type:"next",size:36,title:"下一曲 Ctrl + Right"},on:{click:t.next}})],1),i("div",{staticClass:"music-music"},[i("div",{staticClass:"music-bar-info"},[t.currentMusic&&t.currentMusic.id?[t._v("\n          "+t._s(t.currentMusic.name)+"\n          "),i("span",[t._v("- "+t._s(t.currentMusic.singer))])]:[t._v("欢迎使用mmPlayer在线音乐播放器")]],2),t.currentMusic.id?i("div",{staticClass:"music-bar-time"},[t._v(t._s(t._f("format")(t.currentTime))+"/"+t._s(t._f("format")(t.currentMusic.duration%3600)))]):t._e(),i("mm-progress",{staticClass:"music-progress",attrs:{percent:t.percentMusic,"percent-progress":t.currentProgress},on:{percentChange:t.progressMusic}})],1),i("mm-icon",{staticClass:"icon-color pointer mode",attrs:{type:t.getModeIconType(),title:t.getModeIconTitle(),size:30},on:{click:t.modeChange}}),i("mm-icon",{staticClass:"icon-color pointer comment",attrs:{type:"comment",size:30},on:{click:t.openComment}}),i("div",{staticClass:"music-bar-volume",attrs:{title:"音量加减 [Ctrl + Up / Down]"}},[i("volume",{attrs:{volume:t.volume},on:{volumeChange:t.volumeChange}})],1)],1),i("div",{staticClass:"mmPlayer-bg",style:{backgroundImage:t.picUrl}}),i("div",{staticClass:"mmPlayer-mask"})])},n=[],s=(i("5ab2"),i("6d57"),i("e10e"),i("e204"),i("163d"),i("9d37")),c=i("365c"),o=i("db49"),a={initAudio:function(t){var e=t.audioEle;e.onprogress=function(){try{if(e.buffered.length>0){var i=t.currentMusic.duration,r=0;e.buffered.end(0),r=e.buffered.end(0)>i?i:e.buffered.end(0),t.currentProgress=r/i}}catch(n){}},e.onplay=function(){var e;clearTimeout(e),e=setTimeout((function(){t.musicReady=!0}),100)},e.ontimeupdate=function(){t.currentTime=e.currentTime},e.onended=function(){t.mode===o["f"].loop?t.loop():t.next()},e.onerror=function(){t.$mmToast("当前音乐不可播放，已自动播放下一曲"),t.next()},e.onstalled=function(){var i;e.load(),t.setPlaying(!1),clearTimeout(i),i=setTimeout((function(){t.setPlaying(!0)}),10)},e.oncanplay=function(){0!==t.historyList.length&&t.currentMusic.id===t.historyList[0].id||t.setHistory(t.currentMusic)}}},u=a,l=i("ca00"),m=i("5d2d"),d=i("08c1"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"mmProgress",staticClass:"mmProgress",on:{click:t.barClick}},[i("div",{staticClass:"mmProgress-bar"}),i("div",{ref:"mmPercentProgress",staticClass:"mmProgress-outer"}),i("div",{ref:"mmProgressInner",staticClass:"mmProgress-inner"},[i("div",{staticClass:"mmProgress-dot",on:{mousedown:t.barDown,touchstart:function(e){return e.preventDefault(),t.barDown(e)}}})])])},f=[],v=10,p={name:"MmProgress",props:{percent:{type:[Number],default:0},percentProgress:{type:[Number],default:0}},data:function(){return{move:{status:!1,startX:0,left:0}}},watch:{percent:function(t){if(t>=0&&!this.move.status){var e=this.$refs.mmProgress.clientWidth-v,i=t*e;this.moveSilde(i)}},percentProgress:function(t){var e=this.$refs.mmProgress.clientWidth*t;this.$refs.mmPercentProgress.style.width="".concat(e,"px")}},mounted:function(){var t=this;this.$nextTick((function(){t.bindEvents();var e=t.$refs.mmProgress.clientWidth-v,i=t.percent*e;t.moveSilde(i)}))},beforeDestroy:function(){this.unbindEvents()},methods:{bindEvents:function(){document.addEventListener("mousemove",this.barMove),document.addEventListener("mouseup",this.barUp),document.addEventListener("touchmove",this.barMove),document.addEventListener("touchend",this.barUp)},unbindEvents:function(){document.removeEventListener("mousemove",this.barMove),document.removeEventListener("mouseup",this.barUp),document.removeEventListener("touchmove",this.barMove),document.removeEventListener("touchend",this.barUp)},barClick:function(t){var e=this.$refs.mmProgress.getBoundingClientRect(),i=Math.min(this.$refs.mmProgress.clientWidth-v,Math.max(0,t.clientX-e.left));this.moveSilde(i),this.commitPercent()},barDown:function(t){this.move.status=!0,this.move.startX=t.clientX||t.touches[0].pageX,this.move.left=this.$refs.mmProgressInner.clientWidth},barMove:function(t){if(!this.move.status)return!1;t.preventDefault();var e=t.clientX||t.touches[0].pageX,i=e-this.move.startX,r=Math.min(this.$refs.mmProgress.clientWidth-v,Math.max(0,this.move.left+i));this.moveSilde(r),this.commitPercent()},barUp:function(t){this.move.status=!1},moveSilde:function(t){this.$refs.mmProgressInner.style.width="".concat(t,"px")},commitPercent:function(){var t=this.$refs.mmProgress.clientWidth-v,e=this.$refs.mmProgressInner.clientWidth/t;this.$emit("percentChange",e)}}},y=p,g=(i("0908"),i("5511")),b=Object(g["a"])(y,h,f,!1,null,null,null),C=b.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music-btn"},[i("router-link",{attrs:{to:"/music/playlist",tag:"span"}},[t._v("正在播放")]),i("router-link",{attrs:{to:"/music/toplist",tag:"span"}},[t._v("推荐")]),i("router-link",{attrs:{to:"/music/search",tag:"span"}},[t._v("搜索")]),i("router-link",{staticClass:"none-414",attrs:{to:"/music/userlist",tag:"span"}},[t._v("我的歌单")]),i("router-link",{attrs:{to:"/music/historylist",tag:"span"}},[t._v("我听过的")]),i("router-link",{attrs:{to:"/music/fm",tag:"span"}},[t._v("FM电台")])],1)},M=[],x={},O=x,_=(i("4814"),Object(g["a"])(O,P,M,!1,null,"1561c5b9",null)),w=_.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("dl",{staticClass:"music-info"},[i("dt",[i("img",{attrs:{src:t.musicPicUrl}})]),t.currentMusic.id?[i("dd",[t._v("歌曲名："+t._s(t.currentMusic.name))]),i("dd",[t._v("歌手名："+t._s(t.currentMusic.singer))]),i("dd",[t._v("专辑名："+t._s(t.currentMusic.album))])]:[i("dd",[t._v("mmPlayer在线音乐播放器")]),i("dd",[i("a",{staticClass:"hover",attrs:{target:"_blank",href:"https://github.com/maomao1996"}},[i("mm-icon",{attrs:{type:"github",size:14}}),t._v(" 茂茂\n        ")],1)])]],2),i("div",{ref:"musicLyric",staticClass:"music-lyric"},[i("div",{staticClass:"music-lyric-items",style:t.lyricTop},[t.currentMusic.id?t.nolyric?i("p",[t._v("暂无歌词！")]):t.lyric.length>0?t._l(t.lyric,(function(e,r){return i("p",{key:r,class:{on:t.lyricIndex===r}},[t._v(t._s(e.text))])})):i("p",[t._v("歌词加载失败！")]):i("p",[t._v("还没有播放音乐哦！")])],2)])])},k=[];function E(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?E(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var I={name:"Lyric",props:{lyric:{type:Array,default:function(){return[]}},nolyric:{type:Boolean,default:!1},lyricIndex:{type:Number,default:0}},data:function(){return{top:0}},computed:T({musicPicUrl:function(){return this.currentMusic.id?"".concat(this.currentMusic.image,"?param=300y300"):i("2262")},lyricTop:function(){return"transform :translate3d(0, ".concat(-34*(this.lyricIndex-this.top),"px, 0)")}},Object(d["c"])(["currentMusic"])),mounted:function(){var t=this;window.addEventListener("resize",(function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout((function(){return t.clacTop()}),60)})),this.$nextTick((function(){return t.clacTop()}))},methods:{clacTop:function(){var t=this.$refs.musicLyric,e=window.getComputedStyle(t),i=e.display,r=void 0===i?"":i;if("none"!==r){var n=t.offsetHeight;this.top=Math.floor(n/34/2)}}}},$=I,L=(i("3169"),Object(g["a"])($,j,k,!1,null,"5d512624",null)),S=L.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"volume"},[i("mm-icon",{staticClass:"pointer volume-icon",attrs:{type:t.getVolumeIconType(),size:30},on:{click:t.handleToggleVolume}}),i("div",{staticClass:"volume-progress-wrapper"},[i("mm-progress",{attrs:{percent:t.volumeProgress},on:{percentChange:t.handleVolumeChange}})],1)],1)},D=[],U={name:"Volume",components:{MmProgress:C},props:{volume:{type:Number,required:!0}},computed:{volumeProgress:function(){return this.volume},isMute:{get:function(){return 0===this.volumeProgress},set:function(t){var e=t?0:this.lastVolume;t&&(this.lastVolume=this.volumeProgress),this.handleVolumeChange(e)}}},methods:{getVolumeIconType:function(){return this.isMute?"volume-off":"volume"},handleToggleVolume:function(){this.isMute=!this.isMute},handleVolumeChange:function(t){this.$emit("volumeChange",t)}}},N=U,V=(i("12f8"),Object(g["a"])(N,R,D,!1,null,"d34f3866",null)),z=V.exports;function X(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function A(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?X(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var W={name:"Music",components:{MmProgress:C,MusicBtn:w,Lyric:S,Volume:z},filters:{format:l["b"]},data:function(){var t=Object(m["e"])();return{musicReady:!1,currentTime:0,currentProgress:0,lyric:[],nolyric:!1,lyricIndex:0,isMute:!1,volume:t}},computed:A({picUrl:function(){return this.currentMusic.id&&this.currentMusic.image?"url(".concat(this.currentMusic.image,"?param=300y300)"):"url(".concat(o["c"],")")},percentMusic:function(){var t=this.currentMusic.duration;return this.currentTime&&t?this.currentTime/t:0}},Object(d["c"])(["audioEle","mode","playing","playlist","orderList","currentIndex","currentMusic","historyList"])),watch:{currentMusic:function(t,e){var i=this;t.id?t.id!==e.id&&(this.audioEle.src=t.url,this.lyricIndex=this.currentTime=this.currentProgress=0,this.audioEle.play(),this.$nextTick((function(){i._getLyric(t.id)}))):this.lyric=[]},playing:function(t){var e=this,i=this.audioEle;this.$nextTick((function(){t?i.play():i.pause(),e.musicReady=!0}))},currentTime:function(t){if(!this.nolyric){for(var e=0,i=0;i<this.lyric.length;i++)t>this.lyric[i].time&&(e=i);this.lyricIndex=e}}},mounted:function(){var t=this;this.$nextTick((function(){u.initAudio(t),t.initKeyDown(),t.volumeChange(t.volume),t.musicReady=t.audioEle.isReady}))},methods:A({initKeyDown:function(){var t=this;document.onkeydown=function(e){switch(e.ctrlKey&&e.keyCode){case 32:t.play();break;case 37:t.prev();break;case 38:var i=Number((t.volume+=.1).toFixed(1));i>1&&(i=1),t.volumeChange(i);break;case 39:t.next();break;case 40:var r=Number((t.volume-=.1).toFixed(1));r<0&&(r=0),t.volumeChange(r);break;case 79:t.modeChange();break}}},prev:function(){if(this.musicReady)if(1===this.playlist.length)this.loop();else{var t=this.currentIndex-1;t<0&&(t=this.playlist.length-1),this.setCurrentIndex(t),!this.playing&&this.musicReady&&this.setPlaying(!0),this.musicReady=!1}},play:function(){this.musicReady&&this.setPlaying(!this.playing)},next:function(){if(this.musicReady){if(this.playlist.length-1===this.currentIndex&&this.mode===o["f"].order)return this.setCurrentIndex(-1),void this.setPlaying(!1);if(1===this.playlist.length)this.loop();else{var t=this.currentIndex+1;t===this.playlist.length&&(t=0),!this.playing&&this.musicReady&&this.setPlaying(!0),this.setCurrentIndex(t),this.musicReady=!1}}},loop:function(){this.audioEle.currentTime=0,this.audioEle.play(),this.setPlaying(!0),this.lyric.length>0&&(this.lyricIndex=0)},progressMusic:function(t){this.audioEle.currentTime=this.currentMusic.duration*t},modeChange:function(){var t=(this.mode+1)%4;if(this.audioEle.playMode=t,this.setPlayMode(t),t!==o["f"].loop){var e=[];switch(t){case o["f"].listLoop:case o["f"].order:e=this.orderList;break;case o["f"].random:e=Object(l["d"])(this.orderList);break}this.resetCurrentIndex(e),this.setPlaylist(e)}},resetCurrentIndex:function(t){var e=this,i=t.findIndex((function(t){return t.id===e.currentMusic.id}));this.setCurrentIndex(i)},openComment:function(){if(!this.currentMusic.id)return this.$mmToast("还没有播放歌曲哦！"),!1;this.$router.push("/music/comment/".concat(this.currentMusic.id))},volumeChange:function(t){this.isMute=0===t,this.volume=t,this.audioEle.volume=t,Object(m["j"])(t)},getModeIconType:function(){var t;return(t={},Object(s["a"])(t,o["f"].listLoop,"loop"),Object(s["a"])(t,o["f"].order,"sequence"),Object(s["a"])(t,o["f"].random,"random"),Object(s["a"])(t,o["f"].loop,"loop-one"),t)[this.mode]},getModeIconTitle:function(){var t,e="Ctrl + O";return(t={},Object(s["a"])(t,o["f"].listLoop,"列表循环 ".concat(e)),Object(s["a"])(t,o["f"].order,"顺序播放 ".concat(e)),Object(s["a"])(t,o["f"].random,"随机播放 ".concat(e)),Object(s["a"])(t,o["f"].loop,"单曲循环 ".concat(e)),t)[this.mode]},_getLyric:function(t){var e=this;Object(c["f"])(t).then((function(t){200===t.status&&(t.data.nolyric?e.nolyric=!0:(e.nolyric=!1,e.lyric=Object(l["c"])(t.data.lrc.lyric)),e.audioEle.play())}))}},Object(d["d"])({setPlaying:"SET_PLAYING",setPlaylist:"SET_PLAYLIST",setCurrentIndex:"SET_CURRENTINDEX"}),{},Object(d["b"])(["setHistory","setPlayMode"]))},B=W,F=(i("1a26"),Object(g["a"])(B,r,n,!1,null,null,null));e["default"]=F.exports},bb0f:function(t,e,i){},c065:function(t,e,i){},ca00:function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return c})),i.d(e,"b",(function(){return o}));i("163d"),i("f548"),i("9e76"),i("9a33");function r(t,e){var i=-1,r=t.length;e||(e=new Array(r));while(++i<r)e[i]=t[i];return e}var n=function(t){var e=null==t?0:t.length;if(!e)return[];var i=-1,n=e-1,s=r(t);while(++i<e){var c=i+Math.floor(Math.random()*(n-i+1)),o=s[c];s[c]=s[i],s[i]=o}return t};function s(t){return t<10?"0"+t:t}function c(t){for(var e=t.split("\n"),i=[],r=0;r<e.length;r++){var n=decodeURIComponent(e[r]),s=/\[\d*:\d*((\.|:)\d*)*\]/g,c=n.match(s);if(c)for(var o=n.replace(s,""),a=0,u=c.length;a<u;a++){var l=c[a],m=Number(String(l.match(/\[\d*/i)).slice(1)),d=Number(String(l.match(/:\d*/i)).slice(1)),h=60*m+d;""!==o&&i.push({time:h,text:o})}}return i}function o(t){var e=Math.floor(t/60),i=Math.floor(t%60);return"".concat(s(e),":").concat(s(i))}}}]);
//# sourceMappingURL=chunk-946d62a8.d31e096d.js.map